name:   CI tests

on:
        push:
                branches:
                        - "master"
        pull_request:
                branches:
                        - "master"
        workflow_dispatch:
                branches:
                        - "develop/*"

jobs:
        checkout:
                runs-on: ubuntu-latest
                steps:
                        - uses: actions/checkout@v3
                        - name: Repository checkout
                          run: ls
        test:
                runs-on: ubuntu-latest
                container: ghcr.io/dirack/madagascarenvironment:1.0.1
                needs: checkout
                steps:
                        - name: Clone GuillaumeFalourd/poc-github-actions PUBLIC repository
                          uses: GuillaumeFalourd/clone-github-repo-action@v2.3
                          with:
                                  depth: 1 
                                  branch: 'master'
                                  owner: 'dirack'
                                  repository: 'vfsa'

                        - name: Build docker image and run tests
                          run: |
                                  echo "Build the image in the Dockerfile and call 'make -C test' to run all the tests"

