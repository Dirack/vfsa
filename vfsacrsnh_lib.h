/* This file is automatically generated. DO NOT EDIT! */

#ifndef _vfsacrsnh_lib_h
#define _vfsacrsnh_lib_h


#define Beta_MAX 1 // Beta maximum value
#define Beta_MIN -1 // Beta minimun value
#define BETA_APERTURE Beta_MAX-Beta_MIN 
#define Rnip_MAX 4 // RNIP maximum value
#define Rnip_MIN 0 // RNIP minimum value
#define RNIP_APERTURE Rnip_MAX-Rnip_MIN
#define Rn_MAX 5 // RN maximum value
#define Rn_MIN 0 // RN minimum value
#define RN_APERTURE Rn_MAX-Rn_MIN
#define hMAX 50 // Max of samples to stack in half-offset
#define mMAX 50 // Max of samples to stack in CMP
#define ITMAX 5000 // Maximum number of iterations in VFSA
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <rsf.h>


#define signal(s) ((s<0)?(-1.):(1.))
/*< Signal function >*/


float getRandomNumberBetween0and1();
/*< Function to get a random number between 0 and 1 >*/


float getVfsaIterationTemperature(	int iteration /* Number of the current iteration */,
					float dampingFactor /* C0, the VFSA damping factor */,
					float initialTemperature /* T0, the VFSA Initial temperature */);
/*< Temperature function for VFSA algorithm >*/


void disturbParameters(  float temperature /* Temperature of the current iteration */,
			 float* disturbedParameter /* disturbed parameters vector */,
			 float* parameter /* parameters vector */);
/*< Disturb parameters from the previous VFSA iteration

Note: It receives a parameter vector and distubs it accordingly to 
VFSA algorithm disturb parameters step.
 >*/


void nonHyperbolicCRSapp(	float t[2*mMAX+1][hMAX] /* non-hyperbolic CRS traveltime surface */,
				float m0 /* Central CMP of the approximation */,
				float dm, /* CMP sampling */
				float om /* CMP axis origin */,
				float dh /* half-offset sampling */,
				float oh /* half-offset axis origin */,
				float t0 /* Normal ray traveltime */,
				float v0 /* Near surface velocity */,
				float RN /* RN, CRS parameter */,
				float RNIP /* RNIP, CRS parameter */,
				float BETA /* BETA, CRS parameter */);
/*< Returns the Non hyperbolic CRS approximation surface (FOMEL; KAZINNIK, 2013) >*/


float semblance(float m0 /* Central CMP of the approximation */,
		float dm /* CMP sampling */,
		float om /* CMP axis origin */,
		float oh /* half-offset axis origin */,
		float dh /* half-offset axis sampling */,
		float dt /* time sampling */,
		int nt /* number of time samples */,
		float t0 /* Normal ray traveltime */,
		float v0 /* Near surface velocity */,
		float RN /* RN, CRS parameter */,
		float RNIP /* RNIP, CRS parameter */,
		float BETA /* BETA, CRS parameter */,
		float*** t /* reflection data cube A(m,h,t) */);
/*< Calculate semblance between the Non Hyperbolic CRS approximation surface and reflection data >*/

#endif
